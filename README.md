## 第1章		嵌入式系统

#### 思考与扩展

1.什么是嵌人式系统?嵌入式系统与通用计算机系统有哪些区别?  
2.嵌入式系统有哪些特点?  
3．结合嵌入式系统应用,分析嵌入式系统的发展趋势。
4．什么是交叉编译和交叉调试?与本地编译和调试有何区别?
5．查找资料,了解嵌入式硬件开发的过程及开发板制作工艺。
6．查找资料,了解嵌入式软件开发各阶段所需要的开发平台。

## 第2章		STM32嵌入式芯片

#### 本章小结

本章首先介绍ARM处理器的结构特点及典型ARM处理器系列,然后对ARMCortex-M3系列处理器进行单独讨论,接着简述基于Cortex-M3内核的STM32芯片的系统架构,开发方式以及STM32芯片SW调试模式,最后介绍在STM32开发中非常重要的时钟系统。由于STM32芯片在嵌入式领域介于低端和高端之间,通过对STM32的学习能够为嵌入式系统开发打下坚实的基础。

#### 思考与扩展

1.基于ARM体系结构的单片机有哪些系列?
2．简述ARM Cortex-M3系列处理器特点。
3.STM32单片机有哪些系列?各自有什么特点?
4．归纳阐述 STM32单片机的基本组成和基本工作原理。
5．分析对比STM32芯片库开发方式和寄存器开发方式的优缺点。
6．分析对比 STM32芯片JTAG和SWD两种调试方式。
7．简述STM32的几个重要时钟。

## 第3章		制作STM32最小系统开发板

#### 本章小结

本章主要讲述了设计并制作以STM32为核心芯片的开发板的过程。首先，简单介绍了Altium Designer电路原理图设计软件的使用方法、DXP平台的使用以及电路设计的基本过程，并从原理图设计到元器件焊接的技巧，介绍了一个STM32最小系统实例的设计。读者通过本章学习，可以对嵌入式系统硬件开发有全面深入的了解。

#### 思考与扩展

1.熟悉DXP平台各菜单命令的操作、编译及排错方法。
2.什么是STM32最小系统？
3.STM32的启动模式有几种？BOOT引脚有几个？各自有哪些要求？
4.结合实际操作，总结电路板焊接过程中的注意事项。
5.观察设计的开发板的各个接口位置、形态，理解其功能实现的接线方法。
6.参考本章介绍的开发板，请自己设计一个STM32最小系统。

## 第4章		搭建软件开发环境 

#### 本章小结

本章主要介绍了软件开发环境的搭建方式，介绍了开发环境MDK的安装和使用，包括程序运行、仿真以及开发中使用的烧录工具和调试助手的安装，这些是进行STM32开发前的准备工作。

#### 思考与扩展

1.熟悉MDK5开发环境，掌握编译、调试、仿真、下载程序的方法。
2.MDK仿真环境中，设置查看各个端口寄存器内容及输出结果。
3.对比分析CH340端口烧录时SWD和JTAG下载程序的不同之处。
4.建立工程，编译调试，并在MKD仿真环境下运行，设计仿真，查看变量值及运行结果。
5.查找资料，阅读ST固件库中的函数，了解其函数的命名规则。
6.查找资料，了解STM32的软件开发环境还有哪些，各自有什么特点。

## 第5章		STM32开发基础知识

#### 本章小结

本章是STM32开发的基础，主要讲述了MDK5下如何进行STM32工程的创建、编译以及程序的烧录，简单介绍了STM32库函数和寄存器编程的思想，并通过实训项目加深读者的印象。在STM32的编程中，C语言发挥着独特的优势，所以熟练掌握C语言有利于STM32单片机的编程。

#### 思考与扩展

1.搭建一个完整程序的STM32工程模板。
2.打开一个实训工程文件夹，进行新建和删除文件夹以及文件夹中文件的导入和删除操作。
3.编译调试一个实训工程，通过仿真方式，查看变量值、寄存器状态及输出结果。
4.简述STM32工程模板中各文件的作用。
5.对比分析CH340端口烧录时，SWD和JTAG两种方式下载程序的不同。

## 第6章		STM32的I/O应用

#### 本章小结

I/O应用是STM32开发最常见的部分，本章主要讲述了STM32GPIO的工作模式以及如何配置相关寄存器，并介绍了STM32的时钟系统和数码管的基本原理，在今后的开发中都是必备的技能。在本章的后半部分，通过3个经典的实训来深入探索如何使用GPIO，加深读者的印象，提升动手开发能力。

#### 思考与扩展

1.简述I/O口位输出函数的配置方法。
2.请修改实训二（6.3节），分别进行I/O口的不同配置，观察实验现象。
提示：STM32的I/O口的8种配置方式如下：
GPIO Mode AIN 0x0，

```c
//模拟输入GPIO Mode IN FLOATING 0x04，
//浮空输入GPIO_Mode IPD 0x28，
//下拉输入GPIO_Mode_IPU 0x48，
//上拉输入GPIO_Mode_Out_OD 0x14，
//开漏输出GPIO Mode Out PP 0x10，
//通用推挽输出GPIO_Mode_AF_OD 0x1C，
//复用开漏输出GPIO Mode AF PP 0x18
```

/复用推挽3.修改实训二（6.3节），尝试使用GPIO SetBits和GPIO WriteBit两个库函数来点亮二极管，了解一下控制I/O口的其他重要库函数。
4.修改实训二（6.3节），实现LED流水灯设置为全亮后依次点灭，延时设置为1s。
5.修改实训三（6.4节），利用一个按键实现如下功能：按下按键，LED全部点亮，再次按下，LED全部熄灭。
6.简述数码管的段选和位选接口配置过程。
7.修改实训四（6.5节），实现数码管从0~99的显示。
8.修改实训四（6.5节），在4个数码管位上显示不同的数字。
提示：通过4层循环实现数字递增并显示，并减少每一位数字的延时。

## 第7章		STM32的串口应用

#### 思考与扩展

1.简述串口的配置函数。
2.修改实训五（7.3节），将串口波特率设置为14400并自定义收发内容。
3.修改实训五（7.3节），自定义PC和STM32的通信协议。
说明：通信数据格式为：0x680x010x*
0x16，每位数据均为十六进制数，其含义见表7.2。
表7.2自定义通信协议数据含义第一位：0x68起始位：数据起始标志（帧头）第二位：0x01除它本身、起始位和停止位外的数据长度第三位：0x该位为数码管控制位。0x0f：关闭数码管，0x00：数码管显示00,0x01：数码管显示关米01，…，0x09：数码管显示09第四位：0x16停止位：数据结束标志（帧尾）要求实现如下功能：使用串口助手向STM32发送十六进制数据控制数码管的显示，并将接收的数据按表7.2格式要求打包，再返回到串口助手上。例如，发送0f，数码管关闭，不显示任何内容，串口助手显示68010f16：发送00，数码管显示00，串口助手显示68010016；发送01，数码管显示01，串口助手显示68010116；以此类推。
提示：预先定义一个包含4个元素的数组，如RecvData[4]={0x68,0x01,0x0f，
0x16}；每次将从串口调试助手接收的数据作为数码管的段码，并保存在数组的第二个元素
（数组下标从0开始）中，然后再将该数组的全部数据依次从串口发送到串口助手上。

## 第8章		STM32的中断应用

#### 本章小结

本章主要讲述了STM32的中断功能，详细介绍了嵌套向量中断控制器NVIC及其初始化配置方式，EXTI外部中断以及中断服务函数的编写，最后通过中断按键实训，使用单片机中断功能点亮和熄灭LED，了解配置的全过程，使读者更好地掌握中断的应用。

#### 思老与扩展

1.为什么在使用外部中断时需要开启AFIO时钟？
2.AFIO时钟管理的寄存器有哪些？
3.如何开启AFIO时钟？
4.简述抢占优先级和子优先级的设置方法。
5.简述中断线及中断线的配置方法。
6.修改实训六（8.4节），实现按键按下响应中断使得LED反转。

## 第9章		STM32的定时器应用

####  本章小结

本章主要讲述了STM32的通用定时器以及配置定时器的相关寄存器，定时器可与PWM、ADC等结合实现多种应用。灵活掌握定时器的不同应用方式，对STM32系统开发十分重要。

#### 思考与扩展

1.简述STM32定时器的功能特点。
2.STM32有几个定时器？各自主要功能有哪些？
3.简述通用计时器的配置方法以及计时器中断的实现过程。
4.修改实训七（9.3节），使得中断时间设置为10s。
5.修改实训七（9.3节），通过定时器中断来实现流水灯的功能。
提示：可以在中断函数中调用其他函数来实现。
6.修改实训七（9.3节），实现数码管间隔500ms的自动数显功能，数显范围0~9。

## 第10章		STM32的PWM输出

#### 本章小结

本章主要讲述了PWM输出的相关内容，在章节的开始为读者们介绍了什么是PWM，以便理解PWM（脉冲宽度调制）的基本原理；并详细描述了如何配置PWM输出相关寄存器，以便了解参数的影响。最后，通过制作PWM发生器与呼吸灯结合，在动手实践中，轻松掌握PWM的原理。

#### 思考与扩展

1.什么是PMW？简述通过定时器输出PMW波形的原理及库函数的设置步骤。
2.在实训八（10.3节）的基础上，修改PMW频率，观察运行结果。
3.在实训八（10.3节）的基础上，了解无源蜂鸣器的相关函数的配置，将蜂鸣器与PMW相结合。
4.修改实训八（10.3节），实现PWM控制一个LED，间隔100ms，实现亮度从0~
100%的循环变化，每次变化10%。

## 第11章		STM32的 DMA应用

#### 本章小结

本章介绍了DMA和普通传送方式的区别，着重讲解了STM32的DMA结构。实训九（11.4节）中，以串口1发送数据为例，讲解了DMA操作配置的整个过程，读者可以对DMA实现所需的寄存器配置有直观的理解，从而达到学会使用DMA进行数据传输的目的，体会到使用DMA的优点。

#### 思考与扩展

1.简述DMA数据传送方式的特点。
2.简述STM32的DMA操作的完整过程。
3.简述STM32的DMA相关函数及设置方法。
4.简述STM32的DMA如何管理各通道的请求。
5.修改实训九（11.4节），在DMA传输中增加一个流水灯效果。
提示：可以在main（）中替换如下代码：

```c
int main（void）
{
    ul6 i； 
    delay_init（）；
    /延时函数初始化uart init（9600）；
    /串口初始化为9600
    /DMA1通道4，外设为串口1，存储器为SendBuff，长为（TEXT LENTH+2）*100
    MYDMA_Config（DMA1_Channel4，（u32）&USART1->DR，（u32）SendBuff,TEXT_LENTH+2）； for（i=0；i<TEXT_LENTH；i++）
    /填充ASCII字符集数据
    {
        SendBuff[i]=TEXT_TO_SEND[i]；
        /复制TEXT TO SEND语句
    }
    SendBuff[TEXT LENTH]0x0d；
    SendBuff[TEXT LENTH+1]0x0a； while（1）
    {
        USART DMACmd（USART1，USART DMAReg Tx,ENABLE）； MYDMA_Enable（DMA1_Channel4）；
        /开始一次DMA传输//等待DMA传输完成，此时来做另外一件事一点灯for（i=0；i<10；i++）
        /填充ASCII字符集数据
    {
   		 LED1 TOGGLE； delay_ms（100）；
    }
    /1实际应用中，在传输数据期间，可以执行另外的任务
    while（1）
    {
        if（DMA GetFlagStatus（DMA1 FLAG TC4）！=RESET）
        /等待通道4传输完成
        {
            DMA ClearFlag（DMA1 FLAG TC4）；
            /1清除通道4传输完成标志break；
        }
    }
    delay_ms（1000）；
}
```


将流水灯的LED文件夹复制过来，。c文件、。h文件添加进工程，PA0需要加上LED, LED的正极需要接高电平。下载运行后可以观察到，在数据不断出现在串口调试助手中的时候，LED0也在不断闪烁，此时CPU是在控制LED闪烁，而DMA传输是自己完成的。
6.修改实训九（11.4节），设计实现中断多通道数据处理。
说明：DMA传输完成后，可产生中断请求。利用该中断请求，在使能中断情况下，可利用中断响应及时完成多通道数据处理，提高系统的响应速度和实时性。

## 第12章 		STM32的ADC应用

#### 本章小结

本章介绍了STM32的ADC技术参数、工作过程及相关的寄存器结构，通过实训十的单次ADC转换过程，读者可以进一步理解、掌握ADC操作过程中相关的寄存器配置，为ADC与DMA结合的实际控制应用奠定理论基础。

#### 思考与扩展

1.简述ADC主要参数的含义。
2.简述STM32的ADC的主要特性。
3.ADC的功能是通过相关寄存器设置实现的，这些寄存器的功能是什么？
4.如何使用相应的函数进行ADC寄存器配置？
5.尝试用DMA传输ADC测得的电压值，制作实时电压表。
6.设计ADC结合DMA实现数据采样与软件滤波处理。
说明：ADC是个高速设备，ADC采集到的数据是不能直接用的。通常先采集一批数据，然后进行处理，这个过程就是软件滤波。DMA用到这里就很合适。通过ADC高速采集的数据填充到RAM中，填充至一定数量，如32个、64个，MCU再来使用。
设计思路：
（1）初始化函数包括两部分：DMA初始化和ADC初始化。
（2）滤波部分思路：以ADC连续采样3个通道为例，采样数据由DMA进行搬运，一次搬运90个数据，即为1-2-3-1-2-3循环，每个通道各30次，可以存放在二维数组AD_Vlue
[30][3]中，30为每通道30个数据，3为3个通道，根据二维数组存储方式此过程自动完成。
每当一次DMA过程结束后，触发DMA完成中断，进入滤波函数，求出一个通道的30个数据的均值，存放在数组After_filter[3]。整个过程的滤波计算需要CPU参与，但程序中采样结果AD Value[30][3]使用DMA获取，这样可以解决程序复杂性，减轻CPU负载。

## 第13章		STM32与步进电机

#### 本章小结

本章系统介绍了单片机通过电机驱动模块控制步进电机的过程，需要连接驱动模块，另外，输出信号与流水灯类似，但需要注意的是变化速度不要太快，每个节拍需要一定的反应时间。电机驱动模块种类很多，本章所介绍的芯片原理在读者学习使用其他芯片时可以参考。使用电机驱动模块的原因主要就是单片机达不到驱动电机的频率，因此在选择模块的时候重点应该注意功率问题。另外，L298除了可以驱动步进电机外，还可以驱动直流电机，读者也可以参考本章实验使用。

#### 思考与扩展

1.自行编程，实现步进电机的正转、反转。
2.结合按键实验（8.4节），实现电机转动的加速、减速。

## 第14章		STM32与舵机

#### 本章小结

舵机在很多机械装置上都是必不可少的，在本章的学习中，除了介绍舵机的基本原理外，着重强调的就是控制舵机角度的20ms信号。以20ms为周期的信号中，0.5~2.5ms的高电平时长才能提供有效的角度信息，其他周期和占空比的信号会发生一些不常见的错误。另因舵机也是一种功率比较大的设备，所以在单片机调用的时候，并不是直接由单片机供电，但要保证和单片机共地。

#### 思考与扩展

1.结合按键，遥控舵机左转与右转。
2.运用所学知识，设计基于STM32控制的小车。

## 第15章 		STM32与语音合成

#### 本章小结

语音合成实验的主要功能是在语音合成模块中完成的，单片机最主要的工作是完成符合帧格式的指令发送。本章重点是要学习合成指令的方式，即字符串和数组结合的方法，再通过串口按照字节发送出去。实际应用中，编写指令格式的时候可以按位编辑，使用BCD码和十六进制的方法是很容易实现的。最后也按照字节发送，这是因为串口的寄存器每次只能发送1字节的内容。

#### 思考与扩展

1.自行编程，使用SYN6288播放自定义的语音。
2.运用之前所学知识，尝试设立一个定时语音提醒。

## 第16章		STM32与RFID读卡器

## 第17章		STM32与蓝牙串口

## 第18章		STM32与人体红外感应

## 第19章		遥控小车系统设计与实现

## 第20章		简易交互狗系统设计与实现

## 第21章		电子驱蚊器系统设计与实现

## 第22章		室内环境监控系统设计
